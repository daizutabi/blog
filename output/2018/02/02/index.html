<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="daizutabi" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />

    <title>AtomにおけるPython開発環境構築 - 大豆旅</title>

        <link rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous" />
      <link rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous">


      <link rel="stylesheet" href="../../../theme/css/custom/custom.css" />
      <link rel="stylesheet" href="../../../theme/css/pygment.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js" integrity="sha384-FFgGfda92tXC8nCNOxrCQ3R8x1TNkMFqDZVQdDaaJiiVbjkPBXIJBx0o7ETjy8Bh" crossorigin="anonymous"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js" integrity="sha384-ZoaMbDF+4LeFxg6WdScQ9nnR1QC2MIRxA1O9KWEXQwns1G8UNyIEZIQidzb0T1fo" crossorigin="anonymous"></script>
    <![endif]-->

    <link rel="shortcut icon" href="../../../favicon.ico" type="image/vnd.microsoft.icon">
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle"
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="../../../" rel="home">
          <i class="fa fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="divider"></li>
            <li class="">
              <a href="../../../archives.html">Archives</a>
            </li>
          <li class="divider"></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

<div class="jumbotron" id="overview">
  <div class="container">
	<h1><a href="../../../">大豆旅</a></h1>
  </div>
</div>

    <div class="container" id="main-container">
        <div class="" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<div class="article-header">
  <span class="article-header-date">2018年02月02日 (金)</span>
  <span class="article-header-info">
    <i class="fa fa-folder"></i>
    <a href="../../../category/Atom/">Atom</a>
  </span>
  <h1>AtomにおけるPython開発環境構築</h1>
</div>  </header>
  <div class="content-body" itemprop="text articleBody">
	<p>AtomテキストエディタにPython開発環境を構築します．細かい設定を丁寧に説明し，快適な開発環境を整備することを目指します．</p>


<p>それでは，Python開発に役立つパッケージを紹介していきます．各節のヘッダがパッケージ名になっているので，特に記載のない限り，その名前でパッケージを検索してインストールしてください．その後，Settings，Keymap，Stylesheetの各項目を必要に応じて設定していきます．</p>
<h2>1. vim-mode-plus</h2>
<p>AtomでVimキーバインドを実現します．このパッケージがなかったら，Atomを使っていないでしょう．</p>
<h3>1.1. Settings</h3>
<p>以下のキーマップを有効にします．</p>
<ul>
<li><code>Y</code>: 'yank-to-last-character-of-line'</li>
<li><code>_</code>: 'replace-with-register'</li>
<li><code>c c</code>: 'change inner-smart-word'</li>
<li><code>;</code>: 'inner-any-pair' in 'operator-pending-mode'</li>
<li><code>;</code>: 'inner-any-pair' in 'visual-mode'</li>
</ul>
<p>以下の設定を有効にします．</p>
<ul>
<li>Automatically Escape Insert Mode On Activate Pane Item Change</li>
</ul>
<h3>1.2. Keymap</h3>
<p>Markdownなどのファイルを編集するときには，ソフトラップを有効にするので，論理行の移動キーと物理行の移動キーをスワップします．</p>
<p>[File] &gt; [Keymap...]を選択して，<code>keymap.cson</code>を開き，次の行を追加します．好みに応じて変更してください．</p>
<div class="highlight"><pre><span></span># keymap.cson
&#39;atom-text-editor.vim-mode-plus:not(.insert-mode)&#39;:
  &#39;j&#39;: &#39;vim-mode-plus:move-down-screen&#39;
  &#39;k&#39;: &#39;vim-mode-plus:move-up-screen&#39;
  &#39;g j&#39;: &#39;vim-mode-plus:move-down&#39;
  &#39;g k&#39;: &#39;vim-mode-plus:move-up&#39;
</pre></div>


<p>（以下のキーマップの設定では，同様に<code>keymap.cson</code>を編集します．）</p>
<p><code>s</code>キーに，ツリービュー，ペーン，タブ間の移動のプレフィックスの役割を割り当てます．</p>
<div class="highlight"><pre><span></span>&#39;atom-text-editor.vim-mode-plus.normal-mode&#39;:
  &#39;s&#39;: &#39;vim-mode-plus:nop&#39;
  &#39;s f&#39;: &#39;tree-view:toggle-focus&#39;
  &#39;s v&#39;: &#39;pane:split-left-and-copy-active-item&#39;
  &#39;s s&#39;: &#39;pane:split-up-and-copy-active-item&#39;
  &#39;s j&#39;: &#39;window:focus-pane-below&#39;
  &#39;s k&#39;: &#39;window:focus-pane-above&#39;
  &#39;s h&#39;: &#39;window:focus-pane-on-left&#39;
  &#39;s l&#39;: &#39;window:focus-pane-on-right&#39;
  &#39;s n&#39;: &#39;window:focus-next-pane&#39;
  &#39;s p&#39;: &#39;window:focus-previous-pane&#39;
  &#39;s 1&#39;: &#39;pane:show-item-1&#39;
  &#39;s 2&#39;: &#39;pane:show-item-2&#39;
  &#39;s 3&#39;: &#39;pane:show-item-3&#39;
  &#39;s 4&#39;: &#39;pane:show-item-4&#39;
  &#39;s 5&#39;: &#39;pane:show-item-5&#39;
  &#39;s 6&#39;: &#39;pane:show-item-6&#39;
  &#39;s 7&#39;: &#39;pane:show-item-7&#39;
  &#39;s 8&#39;: &#39;pane:show-item-8&#39;
  &#39;s 9&#39;: &#39;pane:show-item-9&#39;
  &#39;s c&#39;: &#39;pane:close&#39;

&#39;.tree-view&#39;:
  &#39;s f&#39;: &#39;tree-view:toggle-focus&#39;
</pre></div>


<p>関数内で，引数の位置をローテーションします．</p>
<div class="highlight"><pre><span></span>&#39;atom-text-editor.vim-mode-plus.normal-mode&#39;:
  &#39;g &gt;&#39;: &#39;vim-mode-plus:rotate-arguments-of-inner-pair&#39;
  &#39;g &lt;&#39;: &#39;vim-mode-plus:rotate-arguments-backwards-of-inner-pair&#39;
</pre></div>


<h2>2. ex-mode</h2>
<p><code>:w</code>などのコマンドを使えるようにします．</p>
<h2>3. vim-mode-plus-keymaps-for-surround</h2>
<p>サラウンド機能のキーマップ設定です．たとえば，ある単語にカーソルを合わせて，<code>y s i w (</code>と入力すると，その単語をカッコでくくります．他に<code>c s</code>，<code>d s</code>などもあります．</p>
<h2>4. cursor-history</h2>
<p>オリジナルのVimと同様にカーソルのジャンプ履歴に素早くアクセスします．</p>
<h3>4.1. Keymap</h3>
<div class="highlight"><pre><span></span>&#39;atom-text-editor.vim-mode-plus.normal-mode&#39;:
  &#39;ctrl-i&#39;: &#39;cursor-history:next&#39;
  &#39;ctrl-o&#39;: &#39;cursor-history:prev&#39;
</pre></div>


<h2>5. quick-highlight</h2>
<p>コードを編集するときに，同じ文字列をハイライトすると，どこで再利用されているか一目でわかります．</p>
<h3>5.1. Keymap</h3>
<div class="highlight"><pre><span></span>&#39;atom-text-editor.vim-mode-plus.normal-mode, atom-text-editor.vim-mode-plus.visual-mode&#39;:
  &#39;ctrl-m&#39;: &#39;vim-mode-plus-user:quick-highlight-word&#39;
  &#39;g m&#39;: &#39;vim-mode-plus-user:quick-highlight&#39;
  &#39;space m&#39;: &#39;quick-highlight:clear&#39;
</pre></div>


<h2>6. tab-numbers</h2>
<p>タブの横にタブの番号を表示します．この数値をもとに<code>s &lt;number&gt;</code>で移動できます．</p>
<h2>7. MagicPython</h2>
<p>Pythonコードのシンタックスハイライターに，MagicPythonを使います．コアパッケージのlanguage-pythonはdisableにします．</p>
<h3>7.1. Settings</h3>
<ul>
<li>Tab Type: soft</li>
</ul>
<h3>7.2. Stylesheet</h3>
<p>色の設定を追加します．[File] &gt; [Stylesheet]を選択して，<code>styles.less</code>を開き，次の行を追加します．好みに応じて変更してください．</p>
<div class="highlight"><pre><span></span><span class="c">/* styles.less */</span>
<span class="nt">atom-text-editor</span> <span class="p">.</span><span class="nc">syntax--source</span><span class="p">.</span><span class="nc">syntax--python</span> <span class="p">{</span>
  <span class="err">.syntax--keyword.syntax--control,</span>
  <span class="err">.syntax--keyword.syntax--operator.syntax--logical,</span>
  <span class="err">.syntax--storage.syntax--type</span> <span class="err">{</span>
    <span class="c">/* font-weight: bold; */</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--entity</span><span class="p">.</span><span class="nc">syntax--name</span><span class="p">.</span><span class="nc">syntax--function</span><span class="p">.</span><span class="nc">syntax--decorator</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#6590FF</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--self</span> <span class="p">{</span>
    <span class="k">font-style</span><span class="p">:</span> <span class="kc">italic</span><span class="p">;</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#A57083</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--fstring</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#6c65ff</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--function</span><span class="p">.</span><span class="nc">syntax--magic</span><span class="o">,</span>
  <span class="p">.</span><span class="nc">syntax--magic</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#63AA63</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--docstring</span><span class="o">,</span>
  <span class="p">.</span><span class="nc">syntax--docstring</span> <span class="p">.</span><span class="nc">syntax--punctuation</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#666666</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--import</span><span class="p">.</span><span class="nc">syntax--keyword</span><span class="p">.</span><span class="nc">syntax--control</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#A69646</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--support</span><span class="p">.</span><span class="nc">syntax--function</span><span class="p">.</span><span class="nc">syntax--builtin</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#A69666</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--support</span><span class="p">.</span><span class="nc">syntax--type</span><span class="p">.</span><span class="nc">syntax--python</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#A696A6</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--arithmetic</span><span class="p">.</span><span class="nc">syntax--operator</span><span class="o">,</span>
  <span class="p">.</span><span class="nc">syntax--keyword</span><span class="p">.</span><span class="nc">syntax--unpacking</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#76A6A6</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--numeric</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#D69696</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="p">.</span><span class="nc">syntax--constant</span><span class="p">.</span><span class="nc">syntax--other</span> <span class="p">{</span>
    <span class="k">color</span><span class="p">:</span> <span class="mh">#D69696</span><span class="p">;</span>
  <span class="p">}</span>
<span class="err">}</span>
</pre></div>


<p>（以下のスタイルシートの設定では，同様に<code>styles.less</code>を編集します．）</p>
<h2>8. autocomplete-plus</h2>
<p>コアパッケージに含まれているので，インストールの必要はありません．</p>
<h3>8.1. Settings</h3>
<p>補完の方法，カーソル移動の方法などを設定します．</p>
<ul>
<li>Keymap For Confirming A Suggestion: tab always, enter when suggestion explicitly selected</li>
<li>Use Core Movement Commands: false</li>
<li>Suppress Activation For Editor Classes: vim-mode-plus.normal-mode, vim-mode-plus.visual-mode, vim-mode-plus.operator-pending-mode, vim-mode-plus.insert-mode.replace</li>
</ul>
<h3>8.2. Keymap</h3>
<p>Vimライクなキー操作で補完候補間を移動できるようにします．この設定を有効にするには，上のUse Core Movement Commandsを非選択にする必要があります．</p>
<div class="highlight"><pre><span></span>&#39;atom-text-editor.autocomplete-active&#39;:
  &#39;ctrl-k&#39;: &#39;autocomplete-plus:move-up&#39;
  &#39;ctrl-j&#39;: &#39;autocomplete-plus:move-down&#39;
  &#39;ctrl-h&#39;: &#39;autocomplete-plus:move-to-top&#39;
  &#39;ctrl-l&#39;: &#39;autocomplete-plus:move-to-bottom&#39;
  &#39;pageup&#39;: &#39;autocomplete-plus:page-up&#39;
  &#39;pagedown&#39;: &#39;autocomplete-plus:page-down&#39;
</pre></div>


<h3>8.3. Stylesheet</h3>
<p>補完リストのフォントサイズを小さめに設定します．</p>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">autocomplete-plus</span> <span class="nt">li</span> <span class="p">{</span>
  <span class="k">font-size</span><span class="p">:</span> <span class="mi">11</span><span class="kt">pt</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h2>9. ide-python</h2>
<p>Atom IDE を使ってPython開発をするためのパッケージです．言語サーバーが必要なので，Condaの<code>base</code>環境下にインストールします：</p>
<div class="highlight"><pre><span></span><span class="o">(</span>base<span class="o">)</span> &gt; pip install python-language-server
</pre></div>


<h3>9.1. Settings</h3>
<p>Condaの<code>base</code>環境にインストールされた<code>pyls.exe</code>をフルパスで指定します．</p>
<ul>
<li>Python Language Server Path: C:\Users\daizu\Miniconda3\Scripts\pyls.exe</li>
</ul>
<h2>10. autocomplete-python</h2>
<p>autocomplete-plusのPython拡張です．本パッケージで提供される機能は， ide-pythonと重複します．しかし，<code>base</code>環境以外の仮想環境下にインストールされたPythonパッケージへのジャンプなどがide-pythonではできない（or 設定方法がわからない）ので，autocomplete-plusも同時に入れておきます．</p>
<h3>10.1. Settings</h3>
<ul>
<li>Use Kite-powered Completions: false</li>
<li>Python Executable Paths: C:\Users\daizu\Miniconda3\python.exe</li>
<li>Extra Paths For Packages: C:\Users\daizu\Miniconda3\envs\example\Lib\site-packages</li>
<li>Case Insensitive Completion: false</li>
<li>Use Fussy Matcher For Completions: false</li>
</ul>
<p>上のExtra Paths For Packagesの設定は一例です．Condaの<code>example</code>環境を登録しています．他にも登録したい仮想環境がある場合には，セミコロンで区切って追記します．</p>
<h2>11. python-ident</h2>
<p>Pythonコード入力時にインデントを自動で調整します．</p>
<h2>12. atom-beautify</h2>
<p>Pythonコードを整形します．ide-pythonでも整形はできますが，atom-beautifyでは，<code>import</code>の並び替えができます．整形するためのPythonパッケージをインストールします：</p>
<div class="highlight"><pre><span></span><span class="o">(</span>base<span class="o">)</span> &gt; pip install autopep8 isort
</pre></div>


<h3>12.1. Settings</h3>
<ul>
<li>Executables &gt; autopep8: C:\Users\daizu\Miniconda3\Scripts\autopep8.exe</li>
<li>Executables &gt; isort: C:\Users\daizu\Miniconda3\Scripts\isort.exe</li>
<li>Sort imports: true</li>
</ul>
<h2>13. Hydrogen</h2>
<p>Jupyter clientを使って，Atom上でPythonコードの実行ができます．インタラクティブな実行が可能なので，非常に重宝します．Hydrogenを使う仮想環境下で，以下を実行します：</p>
<div class="highlight"><pre><span></span><span class="o">(</span>example<span class="o">)</span> &gt; conda install jupyter
<span class="o">(</span>example<span class="o">)</span> &gt; python -m ipykernel install --user --name example
</pre></div>


<h3>13.1. Settings</h3>
<ul>
<li>Language Mappings: {"python": "magicpython"}</li>
</ul>
<h3>13.2. Keymap</h3>
<div class="highlight"><pre><span></span>&#39;atom-text-editor&#39;:
  &#39;f8&#39;: &#39;hydrogen:clear-results&#39;
  &#39;f9&#39;: &#39;hydrogen:run-all-above&#39;
  &#39;f10&#39;: &#39;hydrogen:run-all&#39;
</pre></div>


<h2>14. platformio-ide-terminal</h2>
<p>Atom内でターミナルを実行します．</p>
<h3>14.1. Settings</h3>
<ul>
<li>Auto Run Command: C:\Users\daizu\Miniconda3\Scripts\activate.bat base</li>
<li>Shell Override: C:\Windows\System32\cmd.exe</li>
</ul>
<h2>15. hydrogen-launcher</h2>
<p>Hydrogenで実行中のカーネルに接続されたJupyterコンソールを表示します．</p>
<h3>15.1. Keymap</h3>
<div class="highlight"><pre><span></span>&#39;atom-text-editor&#39;:
  &#39;ctrl-alt-j&#39;: &#39;hydrogen-launcher:launch-jupyter-console-in-platformio-terminal&#39;
</pre></div>


<h2>16. その他のパッケージ</h2>
<p>Pythonとは直接関係ないですが，以下のパッケージもインストールするとよいでしょう．</p>
<ul>
<li>git-plus</li>
<li>file-icons</li>
<li>minimap系</li>
</ul>
<h2>17. 初期化スクリプト</h2>
<p>パッケージではありませんが，文字化けを防ぐために，[File] &gt; [Init Script...]を選択して，<code>init.coffee</code>を開き，次の行を追加します．</p>
<div class="highlight"><pre><span></span><span class="c1"># init.coffee</span>
<span class="nv">process.env.PYTHONIOENCODING = </span><span class="s">&quot;utf-8&quot;</span><span class="p">;</span>
</pre></div>


<p>以上で，開発環境が整いました．</p>
<p><span class="article-header-modified">
      <i class="fa fa-pencil" aria-hidden="true"></i>
      この記事は2018年02月05日 (月)に更新されました．
    </span></p>  </div>


</article>
        </div><!-- /content -->

    </div><!--/.container /#main-container -->

    <footer id="site-footer">
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by
        <a href="http://www.robertiwancz.com/"
           target="_blank">RKI</a>
        </p>
      </address><!-- /colophon  -->
    </footer>


    <!-- javascript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>


  </body>
</html>