ディープラーニングの学習をしていきます．まずは必要なパッケージをインストールしていきます．この記事では，インストール方法を順を追って説明し，ディープラーニングを実践する準備をします．今回インストールするパッケージは，以下の通りです．

* CUDA
* Theano
* TensorFlow
* Keras
* Neural Network Libraries

<!-- PELICAN_END_SUMMARY -->

Windows 10にCUDA，Theano，Keras，およびNeural Network Librariesをインストールします．インストールする環境は以下の通りです：

* OS: Windows 10 Home (64-bit)
* CPU: Intel Core i5-3337U @ 1.80 GHz
* GPU: NVIDIA GeForce GT 735M
* RAM: 8 GB

##  CUDA Toolkit

[https://developer.nvidia.com/cuda-toolkit-archive](https://developer.nvidia.com/cuda-toolkit-archive)で，CUDA Toolkitのバージョンを選択した後，

* Operating System: Windows
* Architecture: x86_64
* Version: 10
* Installer Type: exe (local)

を選び，ダウンロードしたファイルを実行してインストールします．現時点(2018/1/31)で，Neural Network LibrariesはVersion 8.0にしか対応していませんので，最新のVersion 9.1ではなく，8.0を選択しました．

## NVIDIA cuDNN

インストールするにはメンバーシップが必要なので，[https://developer.nvidia.com](https://developer.nvidia.com)の右上のJoinから登録します．

[https://developer.nvidia.com/rdp/cudnn-download](https://developer.nvidia.com/rdp/cudnn-download)で，同意ボタンを選択し，リストの中から，CUDAのバージョンに対応するcuDNNを選択してダウンロードします．ダウンロードした圧縮ファイルを展開します．そして，展開してできた`cudnn-X.X-windows10-x64-vX\cuda`以下をすべて，`C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\vX.X`にコピーします．

## Miniconda

[https://conda.io/miniconda.html](https://conda.io/miniconda.html)で，

* Windows
* Python 3.6
* 64-bit (exe installer)

を選び，ダウンロードしたファイルを実行してインストールします．インストール中の選択肢は，すべてデフォルト設定のまま行います．Miniconda3 4.3.30 (64-bit)がインストールされました．

以下のディープラーニング関連のパッケージは，仮想環境`dl`下にインストールすることにします．スタートメニューからAnaconda Promptを起動し，以下を実行します．

```bash
conda create -n dl
```

## Theano

Kerasのバックエンドとして，主にTensorFlowとTheanoという選択肢があります．ThensorFlowは，Kerasをインストールするときに自動でインストールされます．ここでは，Theanoをインストールしておきます．

```bash
activate dl
conda install theano
```

`m2w64-toolchain`，`libpython`，`libgpuarray`などの依存パッケージも一緒にインストールされます．

コントロールパネルで環境変数を設定します．

* 変数名: `MKL_THREADING_LAYER`
* 変数値:  `GNU`

GPUを使用するために，`~\.theanorc.txt`を作成して，以下の内容で保存します．

```text
[global]
device = cuda
floatX = float32
```

実際にインポートしてみましょう．

```bash
python
>>> import theano
Using cuDNN version 7004 on context None
Mapped name None to device cuda: GeForce GT 735M (0000:01:00.0)
>>> theano.__version__
'1.0.0'
```

正常に動いているようです．

## Keras

同じく仮想環境`dl`下で，Kerasをインストールします．

```bash
conda install keras
```

Kerasをインポートしてみます．Theanoをバックエンドに指定するために，`~\.keras\keras.json`を以下の内容で保存します．

```json
{
    "floatx": "float32",
    "epsilon": 1e-07,
    "backend": "theano",
    "image_data_format": "channels_last"
}
```

インポートしてみます．

```bash
python
>>> import keras
Using Theano backend.
Using cuDNN version 7004 on context None
Mapped name None to device cuda: GeForce GT 735M (0000:01:00.0)
>>> keras.__version__
'2.0.9'
```

## Neural Network Libraries

Neural Network Librariesは，VC++14（Visual Studio 2015相当）でコンパイルされているので、[Visual Studio 2015のRuntime](https://www.microsoft.com/ja-JP/download/details.aspx?id=52685)が必要です．未インストールの場合はインストールしておきます．

以下の順番でNeural Network Librariesをインストールします．

```bash
conda install scipy scikit-image ipython
pip install nnabla
pip install nnabla-ext-cuda
conda install pywin32
```

以上で，ディープラーニングを実行する環境が整いました．
