<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="daizutabi" />

  <link rel="stylesheet" href="https://blog.daizutabi.net/theme/stylesheet/style.css" />
  <link rel="stylesheet" href="https://blog.daizutabi.net/theme/stylesheet/pheasant.css" />
  <link rel='stylesheet' href="//fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link rel='stylesheet' href="//cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css" />
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
  <title>大豆旅 &ndash; 記事の自動ビルドとページのリロード</title>
</head>

<body>
  <aside>
    <div>
      <a href="https://blog.daizutabi.net">
        <img src="https://www.gravatar.com/avatar/425bf792666d158202306d5dc73367d0?s=140" />
      </a>
      <h1><a href="https://blog.daizutabi.net">大豆旅</a></h1>


    </div>
  </aside>
  <main>

<article class="single">
  <header class="article">
    <p><span class="date">2017年12月17日 (日)</span>
    <span class="info"><i class="fa fa-folder"></i> <a href="https://blog.daizutabi.net/category/Pelican/">Pelican</a></span></p>
    <h1>記事の自動ビルドとページのリロード</h1>
  </header>
  <div class="content">
<p><a href="https://github.com/daizutabi/takuhai">Takuhai</a>パッケージを作りました．Pelicanプロジェクト内の記事ファイルが更新されたら次のことを実行します：</p>
<ul>
<li>記事をビルドしてHTMLファイルを生成します．</li>
<li>ローカルのHTTPサーバを立ち上げて，生成した記事をブラウザで表示します．</li>
<li>記事が更新されたら，その都度ビルドして，ブラウザのページを自動でリロードします．</li>
</ul>
<p>本パッケージを作成するにあたって，次の記事を参考にしました：</p>
<ul>
<li><a href="https://merlijn.vandeen.nl/2015/pelican-livereload.html">Using LiveReload with Pelican</a></li>
<li><a href="http://tech.agilitynerd.com/livereload-with-pelican.html">LiveReload with Pelican</a></li>
</ul>
<p>これらの記事が提供する機能に加えて，Takuhaiでは以下の改善を加えています：</p>
<ul>
<li><a href="https://pypi.org">PyPI</a>および<a href="https://anaconda.org">Anaconda Cloud</a>からのインストール．</li>
<li>実行コマンド<code>takuhai</code>の実装．</li>
<li>ホスト名やポート番号の指定．</li>
<li>ブラウザの自動起動．</li>
<li>相対URLと絶対URLの選択．</li>
</ul>
<p>特に有用と考えている「相対URLと絶対URLの選択」について説明します．Takuhaiの実行コマンド<code>takuhai</code>はデフォルトで相対URLを設定します．これは<code>pelicanconf.py</code>の設定を上書きします．</p>
<p>Pelicanドキュメントの<a href="http://docs.getpelican.com/en/stable/settings.html#url-settings">URL settings</a>によれば，絶対URLが望ましい選択とされています．しかし，これではローカルHTTPサーバを立ち上げても，リンク先が外部サイトになってしまいます．望ましい動作とは言えないでしょう．</p>
<p>Takuhaiでは，<code>pelicanconf.py</code>の設定を上書きすることで，ローカルHTTPサーバの場合に限って相対URLを使うことができます．<code>pelicanconf.py</code>の<code>RELATIVE_URLS</code>は常に<code>False</code>にしておきましょう．開発用に<code>takuhai content</code>としたときには相対URLを使い，公開用に<code>pelican content</code>としたときには絶対URLを使います．公開前には忘れずに<code>pelican content</code>を実行しましょう．</p>
<p>Takuhaiのインストールは簡単です．</p>
<div class="pheasant-fenced-code"><div class="source"><pre><code class="bash">&gt; pip install takuhai</code></pre></div></div>

<p>condaパッケージも用意しています．</p>
<div class="pheasant-fenced-code"><div class="source"><pre><code class="bash">&gt; conda install -c daizutabi -c conda-forge takuhai</code></pre></div></div>

<p>インストールができたら，いつも実行している</p>
<div class="pheasant-fenced-code"><div class="source"><pre><code class="bash">&gt; pelican content</code></pre></div></div>

<p>の代わりに</p>
<div class="pheasant-fenced-code"><div class="source"><pre><code class="bash">&gt; takuhai content</code></pre></div></div>

<p>を実行してみましょう．<code>http://localhost:8000</code>にアクセスすると記事が表示されます．記事ファイルを更新すると，ブラウザのページが自動でリロードされ，最新の内容に変更されることが確認できます．</p></div>



</article>

    <footer>
    </footer>
  </main>
</body>

</html>